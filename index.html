<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Will You Be Mine? ðŸ’•</title>
    <style>
        *,
        *::after,
        *::before {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }

        :root {
            --dark-color: #1a1a1a;
            --pink-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
        }

        body {
            min-height: 100vh;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            overflow-x: hidden;
            position: relative;
            background: var(--pink-gradient);
        }

        /* Welcome Animation Styles */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--dark-color);
            z-index: 9999;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            perspective: 1000px;
            transition: opacity 1s ease-out;
        }

        .welcome-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .night {
            position: fixed;
            left: 50%;
            top: 0;
            transform: translateX(-50%);
            width: 100%;
            height: 100%;
            filter: blur(0.1vmin);
            background-image: radial-gradient(ellipse at top, transparent 0%, var(--dark-color)), 
                              radial-gradient(ellipse at bottom, var(--dark-color), rgba(145, 233, 255, 0.2)), 
                              repeating-linear-gradient(220deg, black 0px, black 19px, transparent 19px, transparent 22px), 
                              repeating-linear-gradient(189deg, black 0px, black 19px, transparent 19px, transparent 22px), 
                              repeating-linear-gradient(148deg, black 0px, black 19px, transparent 19px, transparent 22px), 
                              linear-gradient(90deg, #ff69b4, #fecfef);
        }

        .flowers {
            position: relative;
            transform: scale(0.7);
        }

        .flower {
            position: absolute;
            bottom: 10vmin;
            transform-origin: bottom center;
            z-index: 10;
            --fl-speed: 0.8s;
        }

        .flower--1 {
            animation: moving-flower-1 4s linear infinite;
        }

        .flower--1 .flower__line {
            height: 70vmin;
            animation-delay: 0.3s;
        }

        .flower--1 .flower__line__leaf--1 {
            animation: blooming-leaf-right var(--fl-speed) 1.6s backwards;
        }

        .flower--1 .flower__line__leaf--2 {
            animation: blooming-leaf-right var(--fl-speed) 1.4s backwards;
        }

        .flower--1 .flower__line__leaf--3 {
            animation: blooming-leaf-left var(--fl-speed) 1.2s backwards;
        }

        .flower--1 .flower__line__leaf--4 {
            animation: blooming-leaf-left var(--fl-speed) 1s backwards;
        }

        .flower--1 .flower__line__leaf--5 {
            animation: blooming-leaf-right var(--fl-speed) 1.8s backwards;
        }

        .flower--1 .flower__line__leaf--6 {
            animation: blooming-leaf-left var(--fl-speed) 2s backwards;
        }

        .flower--2 {
            left: 50%;
            transform: rotate(30deg);
            animation: moving-flower-2 4s linear infinite;
        }

        .flower--2 .flower__line {
            height: 60vmin;
            animation-delay: 0.8s;
        }

        .flower--2 .flower__line__leaf--1 {
            animation: blooming-leaf-right var(--fl-speed) 1.9s backwards;
        }

        .flower--2 .flower__line__leaf--2 {
            animation: blooming-leaf-right var(--fl-speed) 1.7s backwards;
        }

        .flower--2 .flower__line__leaf--3 {
            animation: blooming-leaf-left var(--fl-speed) 1.5s backwards;
        }

        .flower--2 .flower__line__leaf--4 {
            animation: blooming-leaf-left var(--fl-speed) 1.3s backwards;
        }

        .flower--3 {
            left: 50%;
            transform: rotate(-15deg);
            animation: moving-flower-3 4s linear infinite;
        }

        .flower--3 .flower__line {
            animation-delay: 0.9s;
        }

        .flower--3 .flower__line__leaf--1 {
            animation: blooming-leaf-right var(--fl-speed) 2.5s backwards;
        }

        .flower--3 .flower__line__leaf--2 {
            animation: blooming-leaf-right var(--fl-speed) 2.3s backwards;
        }

        .flower--3 .flower__line__leaf--3 {
            animation: blooming-leaf-left var(--fl-speed) 2.1s backwards;
        }

        .flower--3 .flower__line__leaf--4 {
            animation: blooming-leaf-left var(--fl-speed) 1.9s backwards;
        }

        .flower__leafs {
            position: relative;
            animation: blooming-flower 2s backwards;
        }

        .flower__leafs--1 {
            animation-delay: 1.1s;
        }

        .flower__leafs--2 {
            animation-delay: 1.4s;
        }

        .flower__leafs--3 {
            animation-delay: 1.7s;
        }

        .flower__leafs::after {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            transform: translate(-50%, -100%);
            width: 8vmin;
            height: 8vmin;
            background-color: #ff69b4;
            filter: blur(10vmin);
        }

        .flower__leaf {
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 8vmin;
            height: 11vmin;
            border-radius: 51% 49% 47% 53%/44% 45% 55% 69%;
            background-color: #ff69b4;
            background-image: linear-gradient(to top, #ff1493, #ffb6c1);
            transform-origin: bottom center;
            opacity: 0.9;
            box-shadow: inset 0 0 2vmin rgba(255, 255, 255, 0.5);
        }

        .flower__leaf--1 {
            transform: translate(-10%, 1%) rotateY(40deg) rotateX(-50deg);
        }

        .flower__leaf--2 {
            transform: translate(-50%, -4%) rotateX(40deg);
        }

        .flower__leaf--3 {
            transform: translate(-90%, 0%) rotateY(45deg) rotateX(50deg);
        }

        .flower__leaf--4 {
            width: 8vmin;
            height: 8vmin;
            transform-origin: bottom left;
            border-radius: 4vmin 10vmin 4vmin 4vmin;
            transform: translate(0%, 18%) rotateX(70deg) rotate(-43deg);
            background-image: linear-gradient(to top, #ff1493, #ffb6c1);
            z-index: 1;
            opacity: 0.8;
        }

        .flower__white-circle {
            position: absolute;
            left: -3.5vmin;
            top: -3vmin;
            width: 9vmin;
            height: 4vmin;
            border-radius: 50%;
            background-color: #fff;
        }

        .flower__white-circle::after {
            content: "";
            position: absolute;
            left: 50%;
            top: 45%;
            transform: translate(-50%, -50%);
            width: 60%;
            height: 60%;
            border-radius: inherit;
            background-image: linear-gradient(90deg, #ffeb12, #ffce00);
        }

        .flower__line {
            height: 55vmin;
            width: 1.5vmin;
            background-image: linear-gradient(to left, rgba(0, 0, 0, 0.2), transparent, rgba(255, 255, 255, 0.2)), 
                              linear-gradient(to top, transparent 10%, #14757a, #39c6d6);
            box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.5);
            animation: grow-flower-tree 4s backwards;
        }

        .flower__line__leaf {
            --w: 7vmin;
            --h: calc(var(--w) + 2vmin);
            position: absolute;
            top: 20%;
            left: 90%;
            width: var(--w);
            height: var(--h);
            border-top-right-radius: var(--h);
            border-bottom-left-radius: var(--h);
            background-image: linear-gradient(to top, rgba(20, 117, 122, 0.4), #39c6d6);
        }

        .flower__line__leaf--1 {
            transform: rotate(70deg) rotateY(30deg);
        }

        .flower__line__leaf--2 {
            top: 45%;
            transform: rotate(70deg) rotateY(30deg);
        }

        .flower__line__leaf--3, .flower__line__leaf--4, .flower__line__leaf--6 {
            border-top-right-radius: 0;
            border-bottom-left-radius: 0;
            border-top-left-radius: var(--h);
            border-bottom-right-radius: var(--h);
            left: -460%;
            top: 12%;
            transform: rotate(-70deg) rotateY(30deg);
        }

        .flower__line__leaf--4 {
            top: 40%;
        }

        .flower__line__leaf--5 {
            top: 0;
            transform-origin: left;
            transform: rotate(70deg) rotateY(30deg) scale(0.6);
        }

        .flower__line__leaf--6 {
            top: -2%;
            left: -450%;
            transform-origin: right;
            transform: rotate(-70deg) rotateY(30deg) scale(0.6);
        }

        .flower__light {
            position: absolute;
            bottom: 0vmin;
            width: 1vmin;
            height: 1vmin;
            background-color: #fffb00;
            border-radius: 50%;
            filter: blur(0.2vmin);
            animation: light-ans 4s linear infinite backwards;
        }

        .flower__light:nth-child(odd) {
            background-color: #ff69b4;
        }

        .flower__light--1 {
            left: -2vmin;
            animation-delay: 1s;
        }

        .flower__light--2 {
            left: 3vmin;
            animation-delay: 0.5s;
        }

        .flower__light--3 {
            left: -6vmin;
            animation-delay: 0.3s;
        }

        .flower__light--4 {
            left: 6vmin;
            animation-delay: 0.9s;
        }

        .flower__light--5 {
            left: -1vmin;
            animation-delay: 1.5s;
        }

        .flower__light--6 {
            left: -4vmin;
            animation-delay: 3s;
        }

        .flower__light--7 {
            left: 3vmin;
            animation-delay: 2s;
        }

        .flower__light--8 {
            left: -6vmin;
            animation-delay: 3.5s;
        }

        .grow-ans {
            animation: grow-ans 2s var(--d) backwards;
        }

        /* Main Content Styles */
        .main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
            position: relative;
            z-index: 10;
            opacity: 0;
            transform: translateY(20px);
            transition: all 1s ease-out;
        }

        .main-container.show {
            opacity: 1;
            transform: translateY(0);
        }

        .title {
            font-size: 3em;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .character-container {
            position: relative;
            margin: 30px 0;
            width: 200px;
            height: 200px;
        }

        .gif-character {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .buttons-container {
            display: flex;
            gap: 30px;
            margin-top: 40px;
        }

        .btn {
            padding: 15px 40px;
            font-size: 1.5em;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn-yes {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
        }

        .btn-yes:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(255,107,107,0.4);
        }

        .btn-no {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            color: white;
        }

        .btn-no:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(116,185,255,0.4);
        }

        .message {
            font-size: 1.2em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            margin-top: 20px;
            min-height: 30px;
        }

        .final-message {
            font-size: 2em;
            color: #ff1744;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: shake 0.5s infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .hidden {
            display: none;
        }

        /* Debug panel styles */
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            max-width: 300px;
            z-index: 10000;
        }

        /* Welcome animation keyframes */
        @keyframes grow-ans {
            0% {
                transform: scale(0);
                opacity: 0;
            }
        }

        @keyframes light-ans {
            0% {
                opacity: 0;
                transform: translateY(0vmin);
            }
            25% {
                opacity: 1;
                transform: translateY(-5vmin) translateX(-2vmin);
            }
            50% {
                opacity: 1;
                transform: translateY(-15vmin) translateX(2vmin);
                filter: blur(0.2vmin);
            }
            75% {
                transform: translateY(-20vmin) translateX(-2vmin);
                filter: blur(0.2vmin);
            }
            100% {
                transform: translateY(-30vmin);
                opacity: 0;
                filter: blur(1vmin);
            }
        }

        @keyframes moving-flower-1 {
            0%, 100% {
                transform: rotate(2deg);
            }
            50% {
                transform: rotate(-2deg);
            }
        }

        @keyframes moving-flower-2 {
            0%, 100% {
                transform: rotate(18deg);
            }
            50% {
                transform: rotate(14deg);
            }
        }

        @keyframes moving-flower-3 {
            0%, 100% {
                transform: rotate(-18deg);
            }
            50% {
                transform: rotate(-20deg) rotateY(-10deg);
            }
        }

        @keyframes blooming-leaf-right {
            0% {
                transform-origin: left;
                transform: rotate(70deg) rotateY(30deg) scale(0);
            }
        }

        @keyframes blooming-leaf-left {
            0% {
                transform-origin: right;
                transform: rotate(-70deg) rotateY(30deg) scale(0);
            }
        }

        @keyframes grow-flower-tree {
            0% {
                height: 0;
                border-radius: 1vmin;
            }
        }

        @keyframes blooming-flower {
            0% {
                transform: scale(0);
            }
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @media (max-width: 600px) {
            .title {
                font-size: 2em;
            }
            
            .buttons-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .character-container {
                width: 150px;
                height: 150px;
            }
        }

        .paused * {
            animation-play-state: paused !important;
        }
    </style>
</head>
<body class="paused">
    <!-- Debug Panel -->
    <div class="debug-panel" id="debugPanel">
        <div><strong>Session Info:</strong></div>
        <div id="sessionInfo">Loading...</div>
        <div><strong>Response Log:</strong></div>
        <div id="responseLog">None yet</div>
    </div>

    <div class="welcome-screen" id="welcomeScreen">
        <div class="night"></div>
        <div class="flowers">
            <div class="flower flower--1">
                <div class="flower__leafs flower__leafs--1">
                    <div class="flower__leaf flower__leaf--1"></div>
                    <div class="flower__leaf flower__leaf--2"></div>
                    <div class="flower__leaf flower__leaf--3"></div>
                    <div class="flower__leaf flower__leaf--4"></div>
                    <div class="flower__white-circle"></div>
                    <div class="flower__light flower__light--1"></div>
                    <div class="flower__light flower__light--2"></div>
                    <div class="flower__light flower__light--3"></div>
                    <div class="flower__light flower__light--4"></div>
                    <div class="flower__light flower__light--5"></div>
                    <div class="flower__light flower__light--6"></div>
                    <div class="flower__light flower__light--7"></div>
                    <div class="flower__light flower__light--8"></div>
                </div>
                <div class="flower__line">
                    <div class="flower__line__leaf flower__line__leaf--1"></div>
                    <div class="flower__line__leaf flower__line__leaf--2"></div>
                    <div class="flower__line__leaf flower__line__leaf--3"></div>
                    <div class="flower__line__leaf flower__line__leaf--4"></div>
                    <div class="flower__line__leaf flower__line__leaf--5"></div>
                    <div class="flower__line__leaf flower__line__leaf--6"></div>
                </div>
            </div>

            <div class="flower flower--2">
                <div class="flower__leafs flower__leafs--2">
                    <div class="flower__leaf flower__leaf--1"></div>
                    <div class="flower__leaf flower__leaf--2"></div>
                    <div class="flower__leaf flower__leaf--3"></div>
                    <div class="flower__leaf flower__leaf--4"></div>
                    <div class="flower__white-circle"></div>
                    <div class="flower__light flower__light--1"></div>
                    <div class="flower__light flower__light--2"></div>
                    <div class="flower__light flower__light--3"></div>
                    <div class="flower__light flower__light--4"></div>
                    <div class="flower__light flower__light--5"></div>
                    <div class="flower__light flower__light--6"></div>
                    <div class="flower__light flower__light--7"></div>
                    <div class="flower__light flower__light--8"></div>
                </div>
                <div class="flower__line">
                    <div class="flower__line__leaf flower__line__leaf--1"></div>
                    <div class="flower__line__leaf flower__line__leaf--2"></div>
                    <div class="flower__line__leaf flower__line__leaf--3"></div>
                    <div class="flower__line__leaf flower__line__leaf--4"></div>
                </div>
            </div>

            <div class="flower flower--3">
                <div class="flower__leafs flower__leafs--3">
                    <div class="flower__leaf flower__leaf--1"></div>
                    <div class="flower__leaf flower__leaf--2"></div>
                    <div class="flower__leaf flower__leaf--3"></div>
                    <div class="flower__leaf flower__leaf--4"></div>
                    <div class="flower__white-circle"></div>
                    <div class="flower__light flower__light--1"></div>
                    <div class="flower__light flower__light--2"></div>
                    <div class="flower__light flower__light--3"></div>
                    <div class="flower__light flower__light--4"></div>
                    <div class="flower__light flower__light--5"></div>
                    <div class="flower__light flower__light--6"></div>
                    <div class="flower__light flower__light--7"></div>
                    <div class="flower__light flower__light--8"></div>
                </div>
                <div class="flower__line">
                    <div class="flower__line__leaf flower__line__leaf--1"></div>
                    <div class="flower__line__leaf flower__line__leaf--2"></div>
                    <div class="flower__line__leaf flower__line__leaf--3"></div>
                    <div class="flower__line__leaf flower__line__leaf--4"></div>
                </div>
            </div>

            <div class="grow-ans" style="--d:1.2s">
                <div class="flower__light flower__light--1"></div>
            </div>
            <div class="grow-ans" style="--d:2.4s">
                <div class="flower__light flower__light--2"></div>
            </div>
            <div class="grow-ans" style="--d:2.8s">
                <div class="flower__light flower__light--3"></div>
            </div>
            <div class="grow-ans" style="--d:3.2s">
                <div class="flower__light flower__light--4"></div>
            </div>
        </div>
    </div>

    <div class="main-container" id="mainContainer">
        <h1 class="title">Will You Be Mine? ðŸ’•</h1>
        
        <div class="character-container">
            <img id="characterGif" class="gif-character" src="start.webp" alt="Asking character">
        </div>
        
        <div class="buttons-container" id="buttonsContainer">
            <button class="btn btn-yes" onclick="handleYes()">Yes! ðŸ’•</button>
            <button class="btn btn-no" onclick="handleNo()" id="noBtn">No ðŸ˜”</button>
        </div>
        
        <div class="message" id="message"></div>
    </div>

    <script>
        let noClickCount = 0;
        let userSession = {};
        let responses = [];
        
        const characterGif = document.getElementById('characterGif');
        const message = document.getElementById('message');
        const noBtn = document.getElementById('noBtn');
        const buttonsContainer = document.getElementById('buttonsContainer');
        const welcomeScreen = document.getElementById('welcomeScreen');
        const mainContainer = document.getElementById('mainContainer');

        // GIF URLs (replace with your own)
        const startingGif = "start.webp";
        const firstNoGif = "first.webp";
        const secondNoGif = "second.webp";
        const lastNoGif = "last.webp";

        // Initialize session tracking
        async function initSession() {
            try {
                // Get basic browser info
                userSession = {
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    language: navigator.language,
                    screen: `${screen.width}x${screen.height}`,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    referrer: document.referrer || 'Direct visit',
                    sessionId: generateSessionId()
                };

                // Try to get IP from external service (this works from browser)
                try {
                    const ipResponse = await fetch('https://api.ipify.org?format=json');
                    const ipData = await ipResponse.json();
                    userSession.ip = ipData.ip;
                } catch (e) {
                    userSession.ip = 'Unknown';
                }

                // Update debug panel
                updateDebugPanel();

                // Log session start
                logResponse('SESSION_START', userSession);

            } catch (error) {
                console.log('Session init error:', error);
                userSession = { error: 'Could not initialize session' };
            }
        }

        function generateSessionId() {
            return 'sess_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
        }

        function updateDebugPanel() {
            const sessionInfo = document.getElementById('sessionInfo');
            const responseLog = document.getElementById('responseLog');
            
            sessionInfo.innerHTML = `
                <div>IP: ${userSession.ip || 'Loading...'}</div>
                <div>Session: ${userSession.sessionId}</div>
                <div>Time: ${new Date(userSession.timestamp).toLocaleString()}</div>
            `;
            
            if (responses.length > 0) {
                responseLog.innerHTML = responses.map(r => 
                    `<div>${new Date(r.timestamp).toLocaleTimeString()}: ${r.action}</div>`
                ).join('');
            }
        }

        function logResponse(action, data = {}) {
            const responseData = {
                timestamp: new Date().toISOString(),
                action: action,
                sessionId: userSession.sessionId,
                ip: userSession.ip,
                userAgent: userSession.userAgent,
                data: data
            };
            
            responses.push(responseData);
            updateDebugPanel();
            
            // Store locally
            const allData = {
                session: userSession,
                responses: responses
            };
            
            // In a real implementation, you'd send this to your server
            // For GitHub Pages, we'll use different methods:
            
            // Method 1: Store in browser localStorage
            storeLocally(allData);
            
            // Method 2: Send to external service (uncomment and configure)
            // sendToWebhook(responseData);
            
            // Method 3: Send to Google Sheets (uncomment and configure)
            sendToGoogleSheets(responseData);
            
            console.log('Response logged:', responseData);
        }

        function storeLocally(data) {
            try {
                const existingData = JSON.parse(localStorage.getItem('proposalResponses') || '[]');
                existingData.push(data);
                localStorage.setItem('proposalResponses', JSON.stringify(existingData));
            } catch (e) {
                console.log('Local storage error:', e);
            }
        }

        // Method 2: Send to webhook (Discord, Zapier, etc.)
        function sendToWebhook(data) {
            const webhookUrl = 'YOUR_WEBHOOK_URL_HERE'; // Replace with your webhook URL
            
            fetch(webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    content: `New response: ${data.action}`,
                    embeds: [{
                        title: 'Proposal Response',
                        fields: [
                            { name: 'Action', value: data.action, inline: true },
                            { name: 'IP', value: data.ip || 'Unknown', inline: true },
                            { name: 'Time', value: new Date(data.timestamp).toLocaleString(), inline: true },
                            { name: 'Session', value: data.sessionId, inline: false }
                        ]
                    }]
                })
            }).catch(e => console.log('Webhook error:', e));
        }

        // Method 3: Send to Google Sheets via Google Apps Script
        function sendToGoogleSheets(data) {
            // REPLACE THIS URL with your actual Web App URL from Google Apps Script
            const scriptUrl = 'https://script.google.com/macros/s/AKfycbyyMt01BTlg6HAzGZ0VAn1wUXBD429T-mndeVHZ50XmVMG9Jed2jbSe2Q7URmkwImQ7Ag/exec';
            
            fetch(scriptUrl, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(e => console.log('Google Sheets error:', e));
        }

        // Start the welcome animation sequence
        window.addEventListener('load', async () => {
            // Initialize session tracking
            await initSession();
            
            // Remove paused class to start flower animations
            setTimeout(() => {
                document.body.classList.remove('paused');
            }, 500);
            
            // After flowers finish growing, transition to main content
            setTimeout(() => {
                welcomeScreen.classList.add('fade-out');
                setTimeout(() => {
                    welcomeScreen.style.display = 'none';
                    mainContainer.classList.add('show');
                    logResponse('MAIN_SCREEN_SHOWN');
                }, 1000);
            }, 6000); // Wait for flowers to finish their animation
        });

        function handleYes() {
            logResponse('YES_CLICKED', { 
                noClickCount: noClickCount,
                finalResponse: 'YES',
                responsePattern: responses.filter(r => r.action.includes('_CLICKED')).map(r => r.action).join(' -> ') + ' -> YES'
            });
            
            characterGif.src = "accept.webp"; // Happy GIF
            message.innerHTML = 'ðŸŽ‰ Yay! You made me the happiest! ðŸ’•âœ¨<br>Thank you for saying yes! ðŸ¥°';
            message.style.color = '#fff';
            message.style.fontSize = '1.5em';
            buttonsContainer.style.display = 'none';
            
            // Add celebration effect
            createHearts();
        }

        function handleNo() {
            noClickCount++;
            
            logResponse('NO_CLICKED', { 
                clickNumber: noClickCount,
                totalNoClicks: noClickCount
            });
            
            switch(noClickCount) {
                case 1:
                    characterGif.src = firstNoGif;
                    message.textContent = 'Aww... are you sure? ðŸ¥º';
                    break;
                case 2:
                    characterGif.src = secondNoGif;
                    message.textContent = 'Please reconsider... I really care about you ðŸ˜¢';
                    break;
                case 3:
                    characterGif.src = lastNoGif;
                    message.innerHTML = '<div class="final-message">Ok... I understand... ðŸ’”ðŸ˜­</div>';
                    noBtn.textContent = 'I\'m sorry... ðŸ˜­';
                    noBtn.disabled = true;
                    noBtn.style.opacity = '0.5';
                    
                    logResponse('FINAL_REJECTION', { 
                        finalResponse: 'NO_NO_NO',
                        responsePattern: responses.filter(r => r.action.includes('_CLICKED')).map(r => r.action).join(' -> '),
                        totalInteractions: responses.length
                    });
                    break;
            }
        }

        function createHearts() {
            for (let i = 0; i < 20; i++) {
                const heart = document.createElement('div');
                heart.innerHTML = 'ðŸ’•';
                heart.style.position = 'fixed';
                heart.style.left = Math.random() * window.innerWidth + 'px';
                heart.style.top = window.innerHeight + 'px';
                heart.style.fontSize = Math.random() * 20 + 20 + 'px';
                heart.style.pointerEvents = 'none';
                heart.style.zIndex = '1000';
                heart.style.animation = `floatUp 3s ease-out ${i * 0.1}s forwards`;
                
                document.body.appendChild(heart);
                
                setTimeout(() => {
                    heart.remove();
                }, 3000);
            }
            
            logResponse('CELEBRATION_STARTED');
        }

        // Track page visibility changes
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'hidden') {
                logResponse('PAGE_HIDDEN');
            } else {
                logResponse('PAGE_VISIBLE');
            }
        });

        // Track when user leaves
        window.addEventListener('beforeunload', () => {
            logResponse('PAGE_UNLOAD', {
                timeOnPage: Date.now() - new Date(userSession.timestamp).getTime(),
                finalResponse: responses.filter(r => r.action === 'YES_CLICKED').length > 0 ? 'YES' : 
                              responses.filter(r => r.action === 'FINAL_REJECTION').length > 0 ? 'NO_NO_NO' : 'INCOMPLETE'
            });
        });

        // Add double-click detection for debugging
        document.addEventListener('dblclick', () => {
            // Show all stored data in console for debugging
            const allStoredData = localStorage.getItem('proposalResponses');
            console.log('All stored responses:', JSON.parse(allStoredData || '[]'));
            
            // Also show current session
            console.log('Current session:', { session: userSession, responses: responses });
        });

        // Hide debug panel after 10 seconds (remove this line if you want it always visible)
        setTimeout(() => {
            const debugPanel = document.getElementById('debugPanel');
            debugPanel.style.opacity = '0.3';
            debugPanel.style.fontSize = '10px';
        }, 10000);
    </script>
</body>
</html>